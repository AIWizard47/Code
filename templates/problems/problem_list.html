<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeChallenge Hub - Problems</title>
    <!-- Tailwind CSS CDN for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter for modern typography, with various weights for flexibility -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* -------------------------------------------------------------------------- */
        /* Global & Base Styles                            */
        /* -------------------------------------------------------------------------- */

        /* Ensure body and html take full height and width, prevent overflow */
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden; /* Prevent horizontal scroll on small screens */
            font-family: 'Inter', sans-serif; /* Apply the modern Inter font throughout */
            background-color: #121212; /* Deep dark background for a premium feel */
            color: #e0e0e0; /* Soft white text color for readability */
            line-height: 1.6; /* Improve text readability */
        }

        /* Custom scrollbar styling for a consistent dark theme look */
        ::-webkit-scrollbar {
            width: 10px; /* Wider scrollbar for better usability */
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #282828; /* Darker track to blend with the background */
            border-radius: 5px; /* Slightly more rounded */
        }
        ::-webkit-scrollbar-thumb {
            background: #555; /* Medium gray for the thumb */
            border-radius: 5px;
            border: 1px solid #3a3a3a; /* Subtle border for definition */
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #777; /* Lighter gray on hover for feedback */
        }

        /* -------------------------------------------------------------------------- */
        /* Header Navigation Styles                        */
        /* -------------------------------------------------------------------------- */

        header {
            background-color: #1e1e1e; /* Slightly lighter dark for header */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4); /* More pronounced shadow */
            border-bottom: 1px solid #3a3a3a; /* Defined bottom border */
            padding: 1.5rem 0; /* Increased vertical padding */
            z-index: 100; /* Ensure header stays on top */
            position: sticky; /* Make header sticky */
            top: 0;
            width: 100%;
            /* Added border-radius for curved effect */
            border-bottom-left-radius: 2rem; /* Curve bottom-left corner */
            border-bottom-right-radius: 2rem; /* Curve bottom-right corner */
        }
        header nav a {
            position: relative;
            padding: 0.85rem 1.8rem; /* Larger clickable area */
            border-radius: 0.75rem; /* More rounded corners */
            transition: all 0.35s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smoother transition */
            color: #b0b0b0; /* Muted text color */
            font-weight: 600; /* Slightly bolder font */
            text-decoration: none;
            overflow: hidden; /* Hide overflow for pseudo-element animations */
            display: inline-flex; /* For better alignment with content */
            align-items: center;
            justify-content: center;
            letter-spacing: 0.025em; /* Slight letter spacing */
        }
        header nav a:hover {
            background-color: #333; /* Darker background on hover */
            color: #ffffff; /* Pure white text on hover */
            transform: translateY(-3px) scale(1.01); /* More noticeable lift and slight scale */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
        }
        header nav a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(102, 126, 234, 0.1), transparent); /* Subtle shimmer effect */
            transition: left 0.6s ease-in-out;
            z-index: 1;
        }
        header nav a:hover::before {
            left: 100%;
        }
        header nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 4px; /* Thicker underline */
            background-color: #667eea; /* Vibrant indigo for accent */
            border-radius: 2px;
            transition: width 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smooth width transition */
            z-index: 2;
        }
        header nav a:hover::after {
            width: 90%; /* Wider underline on hover */
        }

        /* -------------------------------------------------------------------------- */
        /* Main Content Area Styling                         */
        /* -------------------------------------------------------------------------- */

        .main-content-area {
            background-color: #1e1e1e; /* Matches header for continuity */
            border-radius: 2rem; /* Even more rounded corners */
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5); /* Deeper shadow for depth */
            border: 1px solid #3a3a3a; /* Consistent border */
            padding: 3rem; /* Generous padding */
            margin-top: 2.5rem; /* Adjusted margin */
            margin-bottom: 2.5rem;
            width: 90%; /* Slightly wider for more content */
            max-width: 1300px; /* Increased max-width */
            animation: fadeIn 1s ease-out forwards; /* Fade-in animation for the whole section */
        }

        /* Keyframe for fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* -------------------------------------------------------------------------- */
        /* Heading Styles                              */
        /* -------------------------------------------------------------------------- */

        .main-heading {
            font-size: 4.5rem; /* Larger, more impactful heading */
            font-weight: 900; /* Extra bold for prominence */
            text-align: center;
            margin-bottom: 3rem; /* More space below heading */
            text-shadow: 0 6px 12px rgba(0, 0, 0, 0.4); /* Stronger text shadow */
            /* Changed gradient colors to match the image's blue/purple glow */
            background: linear-gradient(90deg,rgb(216, 203, 236) 0%, #2196f3 100%); 
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: textGlow 2s infinite alternate; /* Subtle text glow animation */
        }

        /* Keyframe for text glow animation */
        @keyframes textGlow {
            /* Adjusted glow colors to match the new heading gradient */
            from { filter: drop-shadow(0 0 5px rgba(94, 33, 195, 0.5)); }
            to { filter: drop-shadow(0 0 15px rgba(33, 150, 243, 0.8)); }
        }

        /* -------------------------------------------------------------------------- */
        /* Filter Form Styling                            */
        /* -------------------------------------------------------------------------- */

        .filter-form {
            background-color: #121212; /* Deep dark background for form */
            border-radius: 1.75rem; /* More rounded */
            box-shadow: inset 0 3px 10px rgba(0, 0, 0, 0.5); /* Deeper inset shadow */
            border: 1px solid #3a3a3a;
            padding: 2.5rem; /* Increased padding */
            margin-bottom: 3rem; /* More space below form */
            display: flex;
            flex-wrap: wrap;
            gap: 2rem; /* Increased gap between elements */
            align-items: center;
            justify-content: center;
        }
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem; /* Gap between label and input */
            flex-grow: 1; /* Allow groups to grow */
            min-width: 200px; /* Minimum width for filter groups */
        }
        .filter-group label {
            font-size: 1.25rem; /* Larger label font */
            font-weight: 700; /* Bolder label */
            color: #b0b0b0; /* Muted gray for labels */
        }
        .filter-group select, .filter-group input[type="text"] {
            background-color: #282828; /* Darker input background */
            border: 1px solid #555; /* More visible border */
            color: #e0e0e0; /* Light text color */
            padding: 1rem 1.5rem; /* Generous padding */
            border-radius: 1rem; /* More rounded inputs */
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease-in-out;
            appearance: none; /* Remove default select arrow */
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none' stroke='%23e0e0e0'%3e%3cpath d='M7 7l3-3 3 3m0 6l-3 3-3-3' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1.2em; /* Larger arrow */
            cursor: pointer;
        }
        .filter-group input[type="text"] {
            background-image: none; /* No arrow for text input */
        }
        .filter-group select:focus, .filter-group input[type="text"]:focus {
            outline: none;
            border-color: #2575fc; /* Vibrant blue on focus */
            box-shadow: 0 0 0 4px rgba(37, 117, 252, 0.6); /* Thicker ring effect */
        }
        .filter-button {
            background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%); /* Gradient button */
            color: white;
            padding: 1.2rem 3rem; /* Even larger padding */
            border-radius: 1rem; /* More rounded */
            font-weight: 800; /* Extra bold */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4); /* Deeper shadow */
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: none;
            cursor: pointer;
            text-transform: uppercase; /* Uppercase text */
            letter-spacing: 0.05em; /* More letter spacing */
            min-width: 180px; /* Ensure button has a minimum width */
        }
        .filter-button:hover {
            background: linear-gradient(90deg, #2575fc 0%, #6a11cb 100%); /* Reverse gradient on hover */
            transform: translateY(-5px) scale(1.03); /* More pronounced lift and scale */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5); /* Stronger shadow */
        }
        .filter-button:active {
            transform: translateY(0) scale(0.97);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        /* -------------------------------------------------------------------------- */
        /* Problem Cards Grid                              */
        /* -------------------------------------------------------------------------- */

        .problem-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); /* Slightly larger min-width for cards */
            gap: 2rem; /* Increased gap between cards */
        }

        /* -------------------------------------------------------------------------- */
        /* Individual Problem Card Styling                    */
        /* -------------------------------------------------------------------------- */

        .problem-card {
            background-color: #1e1e1e; /* Matches main content area */
            border-radius: 1.25rem; /* More rounded */
            padding: 2rem; /* Generous padding inside card */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); /* Soft shadow */
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), background-color 0.4s ease-in-out;
            border: 1px solid #3a3a3a; /* Subtle border */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            text-decoration: none; /* Remove underline from link */
            position: relative; /* For pseudo-element effects */
            overflow: hidden; /* Hide overflow for glow effect */
        }
        .problem-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(106, 17, 203, 0.1) 0%, transparent 70%); /* Inner glow */
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
            z-index: 0;
        }
        .problem-card:hover::before {
            opacity: 1;
        }
        .problem-card:hover {
            transform: translateY(-8px) scale(1.02); /* Stronger lift and scale */
            box-shadow: 0 18px 30px rgba(0, 0, 0, 0.5); /* Deeper shadow on hover */
            background-color: #282828; /* Darker background on hover */
            border-color: #6a11cb; /* Accent border on hover */
        }
        .problem-card-title {
            font-size: 1.75rem; /* Larger title */
            font-weight: 800; /* Extra bold */
            color: #667eea; /* Vibrant indigo */
            transition: color 0.3s ease-in-out;
            margin-bottom: 0.8rem;
            position: relative; /* Ensure title is above pseudo-elements */
            z-index: 1;
        }
        .problem-card-title:hover {
            color: #8da4f7; /* Lighter indigo on hover */
            text-decoration: none; /* Keep no underline on hover */
        }
        .problem-card-description {
            font-size: 1rem; /* Slightly larger description font */
            color: #c0c0c0; /* Softer gray for description */
            line-height: 1.6;
            margin-bottom: 1.2rem;
            flex-grow: 1;
            position: relative;
            z-index: 1;
        }
        .difficulty-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.4rem 1rem; /* More padding */
            border-radius: 9999px; /* Fully rounded */
            font-size: 0.95rem; /* Slightly larger font */
            font-weight: 700; /* Bolder font */
            margin-bottom: 1rem;
            border: 1px solid;
            text-transform: uppercase; /* Uppercase difficulty */
            letter-spacing: 0.05em;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease-in-out;
            position: relative;
            z-index: 1;
        }
        .difficulty-badge:hover {
            transform: scale(1.05); /* Slight scale on hover */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .difficulty-easy {
            background-color: #1f6b4d; /* Deeper green */
            color: #68d391; /* Brighter green text */
            border-color: #38a169;
        }
        .difficulty-medium {
            background-color: #a06e1e; /* Deeper yellow/orange */
            color: #fbd38d;
            border-color: #ecc94b;
        }
        .difficulty-hard {
            background-color: #9b2c2c; /* Deeper red */
            color: #fc8181;
            border-color: #e53e3e;
        }
        .difficulty-other {
            background-color: #3a3a3a;
            color: #a0aec0;
            border-color: #555;
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem; /* Increased gap */
            margin-top: 1.5rem; /* More space above tags */
            position: relative;
            z-index: 1;
        }
        .tag-badge {
            background-color: #3f51b5; /* Deeper blue for tags */
            color: #e8eaf6; /* Lighter blue text */
            padding: 0.3rem 0.9rem; /* More padding */
            border-radius: 9999px; /* Fully rounded */
            font-size: 0.85rem; /* Slightly larger font */
            font-weight: 600; /* Bolder font */
            border: 1px solid #5c6bc0; /* Lighter blue border */
            transition: all 0.25s ease-in-out;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        .tag-badge:hover {
            background-color: #4e60c7; /* Lighter blue on hover */
            transform: scale(1.08); /* More pronounced scale */
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        /* -------------------------------------------------------------------------- */
        /* Empty State Styling                           */
        /* -------------------------------------------------------------------------- */

        .empty-state {
            text-align: center;
            padding: 4rem; /* More padding */
            background-color: #1a1a1a; /* Darker background */
            border-radius: 1.5rem; /* More rounded */
            border: 2px dashed #4a4a4a; /* Thicker dashed border */
            color: #888; /* Softer gray text */
            font-size: 1.5rem; /* Larger font */
            font-style: italic;
            margin-top: 2rem;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3); /* Inset shadow for depth */
        }
        .empty-state p {
            margin-top: 1rem;
            font-weight: 500;
        }

        /* -------------------------------------------------------------------------- */
        /* Responsive Adjustments                         */
        /* -------------------------------------------------------------------------- */

        @media (max-width: 1024px) {
            .main-content-area {
                padding: 2rem;
                width: 95%;
            }
            .main-heading {
                font-size: 3.5rem;
            }
            .filter-form {
                padding: 1.5rem;
                gap: 1rem;
            }
            .filter-group select, .filter-group input[type="text"] {
                padding: 0.8rem 1.2rem;
            }
            .filter-button {
                padding: 1rem 2rem;
            }
            .problem-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
            }
            .problem-card {
                padding: 1.5rem;
            }
            .problem-card-title {
                font-size: 1.35rem;
            }
        }

        @media (max-width: 768px) {
            header nav a {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
                border-radius: 0.5rem;
            }
            .main-content-area {
                padding: 1.5rem;
                border-radius: 1.5rem;
            }
            .main-heading {
                font-size: 2.8rem;
                margin-bottom: 2.5rem;
            }
            .filter-form {
                padding: 1.2rem;
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            .filter-group {
                width: 100%;
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }
            .filter-group select, .filter-group input[type="text"] {
                width: 100%;
                padding: 0.75rem 1rem;
                font-size: 0.95rem;
            }
            .filter-group label {
                font-size: 1.1rem;
            }
            .filter-button {
                width: 100%;
                padding: 0.9rem 1.8rem;
                font-size: 1rem;
            }
            .problem-grid {
                grid-template-columns: 1fr; /* Single column on small screens */
                gap: 1.2rem;
            }
            .problem-card {
                padding: 1.2rem;
                border-radius: 1rem;
            }
            .problem-card-title {
                font-size: 1.25rem;
                margin-bottom: 0.6rem;
            }
            .problem-card-description {
                font-size: 0.9rem;
                margin-bottom: 1rem;
            }
            .difficulty-badge {
                padding: 0.25rem 0.7rem;
                font-size: 0.8rem;
                margin-bottom: 0.7rem;
            }
            .tag-badge {
                font-size: 0.7rem;
            }
            .empty-state {
                padding: 2rem;
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            .main-heading {
                font-size: 2rem;
                margin-bottom: 2rem;
            }
            header nav a {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
            .main-content-area {
                padding: 1rem;
                margin-top: 1.5rem;
                margin-bottom: 1.5rem;
            }
            .filter-form {
                padding: 1rem;
                gap: 0.8rem;
            }
            .filter-group label {
                font-size: 1rem;
            }
            .filter-group select, .filter-group input[type="text"] {
                padding: 0.6rem 0.8rem;
                font-size: 0.85rem;
            }
            .filter-button {
                padding: 0.8rem 1.5rem;
                font-size: 0.9rem;
            }
            .problem-card {
                padding: 1rem;
            }
            .problem-card-title {
                font-size: 1.1rem;
            }
            .problem-card-description {
                font-size: 0.85rem;
            }
            .difficulty-badge {
                font-size: 0.75rem;
            }
            .tag-badge {
                font-size: 0.65rem;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-black-900 to-gray-700 min-h-screen font-sans text-gray-100 flex flex-col items-center p-4">

    <!-- Header Navigation -->
    <header class="w-full py-6 mb-8 flex justify-center">
        <nav class="space-x-4 md:space-x-8 text-lg font-medium flex flex-wrap justify-center">
            <a href="/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">Problems</a>
            <a href="/contests/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">Contests</a>
            <a href="/submissions/history/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">My Submissions</a>
            <a href="/submissions/leaderboard/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">Leaderboard</a>
            {% if user.is_authenticated %}
                <a href="/logout/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">Logout</a>
            {% else %}
                <a href="/accounts/login/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">Login</a>
                <a href="/account/registrations/" class="text-gray-300 hover:text-white transition duration-200 ease-in-out px-4 py-2 rounded-lg">SignUp</a>
            {% endif %}
        </nav>
    </header>

    <!-- Main Content Area -->
    <div class="main-content-area">
        <h2 class="main-heading">Explore Coding Challenges</h2>

        <!-- Filter and Search Form -->
        <form id="filterForm" method="get" class="filter-form">
            <div class="filter-group flex flex-col sm:flex-row items-center gap-4 w-full md:w-auto">
                <label for="search" class="text-xl font-medium text-gray-300 whitespace-nowrap">Search:</label>
                <input type="text" name="search" id="search" placeholder="Search by title..." value="{{ selected_search }}"
                       class="flex-grow md:max-w-[250px] p-4 border rounded-lg shadow-sm focus:ring-indigo-600 focus:border-indigo-600 bg-gray-700 text-gray-100 placeholder-gray-400 transition-all duration-200 hover:border-gray-500">
            </div>

            <div class="filter-group flex flex-col sm:flex-row items-center gap-4 w-full md:w-auto">
                <label for="difficulty" class="text-xl font-medium text-gray-300 whitespace-nowrap">Difficulty:</label>
                <select name="difficulty" id="difficulty"
                        class="flex-grow md:max-w-[180px] p-4 border rounded-lg shadow-sm focus:ring-indigo-600 focus:border-indigo-600 bg-gray-700 text-gray-100 transition-all duration-200 hover:border-gray-500 cursor-pointer">
                    <option value="">All Difficulties</option>
                    <option value="Easy" {% if selected_difficulty == 'Easy' %}selected{% endif %}>Easy</option>
                    <option value="Medium" {% if selected_difficulty == 'Medium' %}selected{% endif %}>Medium</option>
                    <option value="Hard" {% if selected_difficulty == 'Hard' %}selected{% endif %}>Hard</option>
                </select>
            </div>

            <div class="filter-group flex flex-col sm:flex-row items-center gap-4 w-full md:w-auto">
                <label for="tag" class="text-xl font-medium text-gray-300 whitespace-nowrap">Tag:</label>
                <select name="tag" id="tag"
                        class="flex-grow md:max-w-[180px] p-4 border rounded-lg shadow-sm focus:ring-indigo-600 focus:border-indigo-600 bg-gray-700 text-gray-100 transition-all duration-200 hover:border-gray-500 cursor-pointer">
                    <option value="">All Tags</option>
                    {% for tag in tags %}
                        <option value="{{ tag.name }}" {% if selected_tag == tag.name %}selected{% endif %}>{{ tag.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="filter-button">
                Apply Filters
            </button>
        </form>

        <!-- Problem List Grid -->
        <div id="problemList" class="problem-grid">
            {% for problem in problems %}
            <a href="{% url 'problem_detail' problem.slug %}" class="problem-card">
                <div>
                    <h3 class="problem-card-title">{{ problem.title }}</h3>
                    <span class="difficulty-badge
                        {% if problem.difficulty == 'Easy' %}difficulty-easy
                        {% elif problem.difficulty == 'Medium' %}difficulty-medium
                        {% elif problem.difficulty == 'Hard' %}difficulty-hard
                        {% else %}difficulty-other
                        {% endif %}">
                        {{ problem.difficulty }}
                    </span>
                    <p class="problem-card-description mt-2">
                        {{ problem.short_description|default:"A challenging problem to test your coding skills." }}
                    </p>
                </div>
                <div class="tags-container">
                    {% for tag in problem.tags.all %}
                        <span class="tag-badge">
                            {{ tag.name }}
                        </span>
                    {% endfor %}
                </div>
            </a>
            {% empty %}
            <div class="empty-state col-span-full">
                <p>No problems found matching your criteria. Try adjusting your filters!</p>
            </div>
            {% endfor %}
        </div>

        {% comment %}
            This script block contains mock data and client-side rendering logic for demonstration.
            In a real application, the `problems`, `tags`, `selected_difficulty`, `selected_tag`,
            and `selected_search` variables would be populated by your backend context (e.g., Django views).
            The `renderProblems` and `applyFilters` functions demonstrate how to dynamically
            update the UI based on these filters without a full page reload, if you choose
            to implement client-side filtering.
        {% endcomment %}
        <script>
            // Mock data for demonstration purposes. In a real application, this would come from your backend.
            // DO NOT MODIFY THIS DATA AS PER USER INSTRUCTION "don't add any extra and different data by yourself data fetching leave as it is don't interfere in data so make all data as it is don't add your own questing in this"
            //const allProblems = [
            //    { title: "Two Sum", difficulty: "Easy", slug: "two-sum", short_description: "Find two numbers that add up to a specific target in an array.", tags: [{name: "Arrays"}, {name: "Hashing"}] },
            //    { title: "Longest Substring Without Repeating Characters", difficulty: "Medium", slug: "longest-substring", short_description: "Determine the longest substring in a given string without repeating characters.", tags: [{name: "Strings"}, {name: "Sliding Window"}] },
            //    { title: "Median of Two Sorted Arrays", difficulty: "Hard", slug: "median-sorted-arrays", short_description: "Find the median of two sorted arrays efficiently.", tags: [{name: "Arrays"}, {name: "Divide and Conquer"}] },
            //  { title: "Reverse Linked List", difficulty: "Easy", slug: "reverse-linked-list", short_description: "Reverse a singly linked list iteratively or recursively.", tags: [{name: "Linked List"}] },
            //    { title: "Merge K Sorted Lists", difficulty: "Hard", slug: "merge-k-lists", short_description: "Merge k sorted linked lists into one sorted linked list.", tags: [{name: "Linked List"}, {name: "Heap"}] },
            //    { title: "Valid Parentheses", difficulty: "Easy", slug: "valid-parentheses", short_description: "Check if an input string of parentheses is valid.", tags: [{name: "Strings"}, {name: "Stack"}] },
            //    { title: "Container With Most Water", difficulty: "Medium", slug: "container-water", short_description: "Find two lines that together with the x-axis form a container, such that the container contains the most water.", tags: [{name: "Arrays"}, {name: "Two Pointers"}] },
            //    { title: "Climbing Stairs", difficulty: "Easy", slug: "climbing-stairs", short_description: "You are climbing a staircase. It takes n steps to reach the top. Each time you can either climb 1 or 2 steps. In how many distinct ways can you climb to the top?", tags: [{name: "Dynamic Programming"}, {name: "Recursion"}] },
            //    { title: "Longest Palindromic Substring", difficulty: "Medium", slug: "longest-palindrome", short_description: "Given a string s, return the longest palindromic substring in s.", tags: [{name: "Strings"}, {name: "Dynamic Programming"}] },
            //    { title: "Regular Expression Matching", difficulty: "Hard", slug: "regex-matching", short_description: "Implement regular expression matching with support for '.' and '*'.", tags: [{name: "Strings"}, {name: "Dynamic Programming"}] },
            //    { title: "Binary Tree Inorder Traversal", difficulty: "Easy", slug: "inorder-traversal", short_description: "Given the root of a binary tree, return the inorder traversal of its nodes' values.", tags: [{name: "Tree"}, {name: "Recursion"}] },
            ];

            const allTags = [
                {name: "Arrays"}, {name: "Hashing"}, {name: "Strings"}, {name: "Sliding Window"},
                {name: "Divide and Conquer"}, {name: "Linked List"}, {name: "Heap"}, {name: "Stack"},
                {name: "Two Pointers"}, {name: "Dynamic Programming"}, {name: "Recursion"}, {name: "Tree"},
                {name: "Backtracking"}
            ];

            /**
             * Renders the list of problems into the 'problemList' container.
             * This function dynamically creates and appends problem cards to the DOM.
             * @param {Array<Object>} problemsToRender - An array of problem objects to display.
             */
            function renderProblems(problemsToRender) {
                const problemListContainer = document.getElementById('problemList');
                problemListContainer.innerHTML = ''; // Clear current problems to prepare for new rendering

                // Display an empty state message if no problems match the filters
                if (problemsToRender.length === 0) {
                    problemListContainer.innerHTML = `
                        <div class="empty-state col-span-full">
                            <p>No problems found matching your criteria.</p>
                            <p>Try adjusting your filters or search terms!</p>
                        </div>
                    `;
                    return;
                }

                // Iterate over each problem and create its corresponding card element
                problemsToRender.forEach((problem) => {
                    const problemCard = document.createElement('a');
                    // Set the href attribute for navigation to the problem detail page
                    // This assumes a Django URL pattern like `path('problems/<slug:slug>/', views.problem_detail, name='problem_detail')`
                    problemCard.href = `/problems/${problem.slug}/`;
                    problemCard.className = 'problem-card'; // Apply base card styling

                    // Determine the appropriate CSS class for difficulty badge based on problem difficulty
                    let difficultyClass;
                    if (problem.difficulty === 'Easy') difficultyClass = 'difficulty-easy';
                    else if (problem.difficulty === 'Medium') difficultyClass = 'difficulty-medium';
                    else if (problem.difficulty === 'Hard') difficultyClass = 'difficulty-hard';
                    else difficultyClass = 'difficulty-other'; // Fallback for undefined difficulty

                    // Generate HTML for tags, creating a span for each tag with its styling
                    const tagsHtml = problem.tags.map(tag =>
                        `<span class="tag-badge">${tag.name}</span>`
                    ).join(''); // Join all tag spans into a single string

                    // Populate the inner HTML of the problem card
                    problemCard.innerHTML = `
                        <div>
                            <h3 class="problem-card-title">${problem.title}</h3>
                            <span class="difficulty-badge ${difficultyClass}">
                                ${problem.difficulty}
                            </span>
                            <p class="problem-card-description mt-2">
                                ${problem.short_description || "A challenging problem to test your coding skills."}
                            </p>
                        </div>
                        <div class="tags-container">
                            ${tagsHtml}
                        </div>
                    `;
                    problemListContainer.appendChild(problemCard); // Add the created card to the grid
                });
            }

            /**
             * Applies filters and search terms to the `allProblems` data and re-renders the list.
             * This function reads the current values from the search input, difficulty select,
             * and tag select elements, then filters the `allProblems` array accordingly.
             */
            function applyFilters() {
                // Get current values from filter inputs, converting search input to lowercase for case-insensitive matching
                const searchInput = document.getElementById('search').value.toLowerCase();
                const difficultyFilter = document.getElementById('difficulty').value;
                const tagFilter = document.getElementById('tag').value;

                // Filter the problems based on the selected criteria
                let filteredProblems = allProblems.filter(problem => {
                    // Check if the problem title includes the search input (case-insensitive)
                    const matchesSearch = problem.title.toLowerCase().includes(searchInput);
                    // Check if the difficulty matches the selected filter, or if 'All' is selected
                    const matchesDifficulty = difficultyFilter === '' || problem.difficulty === difficultyFilter;
                    // Check if any of the problem's tags match the selected tag filter, or if 'All' is selected
                    const matchesTag = tagFilter === '' || problem.tags.some(tag => tag.name === tagFilter);
                    
                    // A problem must satisfy all active filters to be included
                    return matchesSearch && matchesDifficulty && matchesTag;
                });

                // Render the filtered list of problems
                renderProblems(filteredProblems);
            }

            /**
             * Event listener for DOMContentLoaded to ensure all HTML elements are available
             * before attempting to initialize JavaScript logic.
             */
            document.addEventListener('DOMContentLoaded', () => {
                // Populate the tags dropdown if it's not already populated by backend context.
                // This is a fallback for client-side rendering or if `tags` context is empty.
                const tagSelect = document.getElementById('tag');
                if (tagSelect.options.length <= 1) { // Checks if only the "All Tags" option exists
                    allTags.forEach(tag => {
                        const option = document.createElement('option');
                        option.value = tag.name;
                        option.textContent = tag.name;
                        tagSelect.appendChild(option);
                    });
                }
                
                // Set initial values for filter elements based on backend context (e.g., from Django template variables).
                // This ensures filters persist across page loads if the backend handles them.
                const initialDifficulty = "{{ selected_difficulty }}"; // Django template variable
                const initialTag = "{{ selected_tag }}"; // Django template variable
                const initialSearch = "{{ selected_search }}"; // Django template variable

                if (initialDifficulty) document.getElementById('difficulty').value = initialDifficulty;
                if (initialTag) document.getElementById('tag').value = initialTag;
                if (initialSearch) document.getElementById('search').value = initialSearch;

                // Apply filters immediately on page load to display the initial set of problems
                // based on any pre-selected filters from the backend or default state.
                applyFilters();

                // Optional: Add event listeners to form elements for dynamic client-side filtering.
                // Uncomment these lines if you want the filters to apply instantly without a full page refresh.
                // If using full page refresh for filtering (default behavior with `method="get"` on form),
                // these client-side listeners are not strictly necessary as the backend will handle filtering.
                // document.getElementById('filterForm').addEventListener('submit', function(e) {
                //     e.preventDefault(); // Prevent default form submission
                //     applyFilters();
                // });
                // document.getElementById('difficulty').addEventListener('change', applyFilters);
                // document.getElementById('tag').addEventListener('change', applyFilters);
                // document.getElementById('search').addEventListener('input', applyFilters); // Live search as user types
            });
        </script>
    </div>

</body>
</html>
