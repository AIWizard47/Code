<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Submissions</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for pre elements */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* Tailwind gray-300 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* Tailwind gray-400 */
        }
        /* Styling for pre tags within table cells for better readability */
        td pre {
            background-color: #f8fafc; /* Tailwind gray-50 */
            border: 1px solid #e2e8f0; /* Tailwind gray-200 */
            padding: 0.75rem;
            border-radius: 0.375rem; /* rounded-md */
            font-size: 0.875rem; /* text-sm */
            line-height: 1.4;
            overflow-x: auto; /* Enable horizontal scrolling if content overflows */
            max-height: 100px; /* Limit height for code/output/error preview */
            white-space: pre-wrap; /* Wrap long lines */
            word-break: break-all; /* Break long words */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen font-sans text-gray-800 flex items-center justify-center p-4">

    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-6xl border border-gray-200">
        <h2 class="text-4xl font-extrabold text-center text-indigo-700 mb-8">Your Submissions</h2>

        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 shadow-md rounded-lg overflow-hidden">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Problem
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Verdict
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Submitted At
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Details
                        </th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for submission in submissions %}
                    <tr class="hover:bg-gray-50 transition duration-150 ease-in-out">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">
                            <a href="{% url 'problem_detail' submission.problem.slug %}" class="hover:underline">
                                {{ submission.problem.title }}
                            </a>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                                {% if submission.verdict == 'Accepted' %}
                                    bg-green-100 text-green-800
                                {% elif submission.verdict == 'Wrong Answer' or submission.verdict == 'Runtime Error' or submission.verdict == 'Time Limit Exceeded' or submission.verdict == 'Memory Limit Exceeded' %}
                                    bg-red-100 text-red-800
                                {% else %}
                                    bg-yellow-100 text-yellow-800
                                {% endif %}">
                                {{ submission.verdict }}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            {{ submission.created_at }}
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-500">
                            <div class="space-y-2">
                                <p class="font-semibold text-gray-700 mb-1">Code:</p>
                                <pre class="bg-gray-50 border-gray-200 text-gray-800">{{ submission.code }}</pre>

                                {% if submission.output %}
                                <p class="font-semibold text-gray-700 mt-2 mb-1">Output:</p>
                                <pre class="bg-gray-50 border-gray-200 text-gray-800">{{ submission.output }}</pre>
                                {% endif %}

                                {% if submission.error %}
                                <p class="font-semibold text-red-600 mt-2 mb-1">Error:</p>
                                <pre class="bg-red-50 border-red-200 text-red-800">{{ submission.error }}</pre>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% comment %}
            Example 'submissions' data structure for local testing:
            <script>
                const submissions = [
                    {
                        problem: { title: "Two Sum", slug: "two-sum" },
                        verdict: "Accepted",
                        created_at: "2023-10-26 10:30:00",
                        code: "def two_sum(nums, target):\n    # Solution code\n    return [0, 1]",
                        output: "Test Case 1: Pass\nTest Case 2: Pass",
                        error: null
                    },
                    {
                        problem: { title: "Longest Substring", slug: "longest-substring" },
                        verdict: "Wrong Answer",
                        created_at: "2023-10-26 11:05:00",
                        code: "def lengthOfLongestSubstring(s):\n    # Incorrect solution\n    return 0",
                        output: "Test Case 1: Pass\nTest Case 2: Failed\nExpected:\n3\nActual:\n0",
                        error: null
                    },
                    {
                        problem: { title: "Median of Two Sorted Arrays", slug: "median-sorted-arrays" },
                        verdict: "Runtime Error",
                        created_at: "2023-10-26 12:00:00",
                        code: "def findMedianSortedArrays(nums1, nums2):\n    # Code with an error\n    raise ValueError(\"Something went wrong\")",
                        output: "",
                        error: "Traceback (most recent call last):\n  File \"solution.py\", line 3, in findMedianSortedArrays\n    raise ValueError(\"Something went wrong\")\nValueError: Something went wrong"
                    },
                    {
                        problem: { title: "Two Sum", slug: "two-sum" },
                        verdict: "Time Limit Exceeded",
                        created_at: "2023-10-26 13:15:00",
                        code: "def two_sum(nums, target):\n    while True: pass # Infinite loop\n    return []",
                        output: "",
                        error: "Execution timed out."
                    }
                ];
                // In a real application, the `submissions` variable would be populated by your backend context.
                // This script block is merely for demonstrating the HTML structure locally.
            </script>
        {% endcomment %}
    </div>

</body>
</html>
